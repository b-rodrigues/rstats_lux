<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>R d3js, and how to make them communicate</title>
<meta name="description" content="A website for users of the R programming language in Luxembourg">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" href="../../css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="../../css/font-awesome.min.css">
<link rel="stylesheet" href="../../css/owl.carousel.css">
<link rel="stylesheet" href="../../css/owl.theme.css">


  <link href="../../css/style.default.css" rel="stylesheet" id="theme-stylesheet">


<link href="../../css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="../../img/favicon.png">


</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              <div id="sidebar" class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
  <div class="sidebar-content">
    <h1 class="sidebar-heading"><a href="../../">Rdata Luxembourg</a></h1>
    
    <ul class="sidebar-menu">
      
      
        <li><a href="../../about/">About</a></li>
      
        <li><a href="../../contact/">Get in touch</a></li>
      
    </ul>
    <p class="social">
  
  
  
  
  
  
  
  
</p>


    <div class="copyright">
      <p class="credit">
        
        | Template by <a href="https://bootstrapious.com/free-templates" class="external">Bootstrapious.com</a>

&amp; ported to Hugo by <a href="https://github.com/kishaningithub">Kishan B</a>

      </p>
    </div>
  </div>
</div>

              
<div class="col-xs-12 col-sm-8 col-md-9 content-column white-background">
  <div class="small-navbar visible-xs">
  <button type="button" data-toggle="offcanvas" class="btn btn-ghost pull-left"> <i class="fa fa-align-left"> </i>Menu</button>
  <h1 class="small-navbar-heading"><a href="../../">Rdata Luxembourg</a></h1>
</div>

  <div class="row">
    <div class="col-lg-8">
      <div class="content-column-content">
         <h1>R d3js, and how to make them communicate</h1>
         <h4>May 16, 2017 by Kevin Rosamont </h4>
         <!-- BLOGDOWN-HEAD -->
<!-- /BLOGDOWN-HEAD -->

<!-- BLOGDOWN-BODY-BEFORE -->
<!-- /BLOGDOWN-BODY-BEFORE -->
<p>Hello everyone,</p>
<p>In this post we will focus on how to send a message from R to javascript. More precisely, we will focus on the basic keywords and knowledge to integrate a d3.js graph into shiny, just like <a href="http://51.254.215.145:3838/shiny-fret/">here</a>. If you have any issue to make shiny and javascript communicate after reading this post, I suggest you to go back to this simple <a href="http://shiny.rstudio.com/gallery/server-to-client-custom-messages.html">shiny app</a> from Rstudio.<br><br></p>
<p>First of all, create a folder where you will put your data file (<code>.csv</code>, <code>.txt</code>, etc..) and your <code>app.R</code> (or <code>ui.R</code> and <code>server.R</code>). In this folder, you will create a new folder that you will name “www”. Put your <code>.css</code> and <code>.js</code> file inside the <code>www</code> folder. <br><br> <img src="../../img/folder_www.png" style = "max-width:100%;"> <br><br></p>
<p>To make R and d3.js communicate, you will have to put some keywords in the server part, the ui part and the <code>.js</code> file.<br><br> In the <code>server.R</code> file, write which data you want to send to javascript in an <code>observe({ })</code> function. Just like below:</p>
<pre><code>function(input, output, session) {
    observe({
        dataSendToJs = &quot;Hello World&quot;
        session$sendCustomMessage(type = &#39;nameOfTheMessage&#39;,dataSendToJs)
    })
}</code></pre>
<p><code>session$sendCustomMessage( )</code> allows you to send your data from shiny to javascript. <br><br></p>
<p>In the <strong>ui.R</strong> file, source the javascript document with a tag function.</p>
<pre><code>fluidPage(
  titlePanel(&quot;Example&quot;),
  fluidRow(
  #Shiny way to integrate html code in the web page
  tags$head(tags$script(src = &quot;message.js&quot;))
  )
)</code></pre>
<p><br></p>
<p>Your <code>.js</code> file has to begin with <code>Shiny.addCustomMessageHandler(&quot;nameOfTheMessage&quot;, function(message) {</code> like in the following example. Don’t forget that the message represents data from R that javascript will read so it’s better to transform the data to json data. You can do it in R via the function <code>jsonlite::toJSON()</code>.</p>
<pre><code>Shiny.addCustomMessageHandler(&quot;nameOfTheMessage&quot;,
                                      function(message) {
                                              alert(JSON.stringify(message));
                                      });</code></pre>
<p>Now it should work! You can find the whole process in this repository. We started with something simple but you can do more complex things by applyng the same logic.</p>
<p>Be careful, if you’re working locally, you have to make some changes: First, you need to have a webserver. I use <a href="https://chrome.google.com/webstore/detail/web-server-for-chrome/ofhbbkphhbklhfoeikjpcbhemlocgigb?hl=en">web server for chrome</a>. If you choose to use the same web server, it’s very simple. <br></p>
<p>First, in “CHOOSE FOLDER”, you have to choose the <code>www</code> folder that you made previously, then a web server url will appear. Click on it, then a new web page with the different files from <code>www</code> should pop-up.<br><br> <img src="../../img/webserver_source.png" style = "max-width:100%;"> <br><br> In <code>ui.R</code> (or the ui part of your single-file shiny app), source <code>d3.min.js</code> and all <code>.css</code> and <code>.js</code> files as follows:</p>
<pre><code>#http://127.0.0.1:8887 represents the web server URL
tags$head(tags$script(src = &quot;http://127.0.0.1:8887/d3.min.js&quot;))</code></pre>
<p>The following video may help you if you have issues to make your application run locally: <iframe width="100%" height="100%" src="https://www.youtube.com/embed/GHRZaiYh2Ac" frameborder="0" allowfullscreen style = "max-width:100%; height:55vh;"></iframe></p>
<p>Now it should work :)</p>
<p><br><br> You can see a complete and reproducible example over <a href="https://github.com/woozaa/fret_Lux">here</a>.<br> Don’t hesitate to contact me if you have any comments or suggestions.</p>

         
      </div>
    </div>
  </div>
</div>

          </div>
      </div>
  </div>
  <script src="../../js/jquery.min.js"></script>
<script src="../../js/bootstrap.min.js"></script>
<script src="../../js/jquery.cookie.js"> </script>
<script src="../../js/ekko-lightbox.js"></script>
<script src="../../js/jquery.scrollTo.min.js"></script>
<script src="../../js/masonry.pkgd.min.js"></script>
<script src="../../js/imagesloaded.pkgd.min.js"></script>
<script src="../../js/owl.carousel.min.js"></script>
<script src="../../js/front.js"></script>

</body>
</html>
